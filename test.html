<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Demo DataTableLib</title>
    <style>
      table {
        border-collapse: collapse;
        width: 100%;
        margin-top: 10px;
      }
      th,
      td {
        border: 1px solid #ccc;
        padding: 6px;
        text-align: left;
      }
      th {
        cursor: pointer;
        background: #f0f0f0;
      }
      #loading {
        display: none;
        color: blue;
      }
      #error {
        color: red;
        display: none;
      }
      .pagination {
        margin-top: 10px;
      }
      .pagination button {
        padding: 5px 10px;
        margin: 0 3px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h1>Test DataTableLib</h1>

    <div id="loading">Đang tải...</div>
    <input type="text" id="search-box" placeholder="Tìm kiếm..." />
    
    <div class="table1">
      <table id="tbl-application">
        <thead></thead>
        <tbody></tbody>
      </table>

      <div class="pagination" id="pagination"></div>
    </div>
    <input type="text" id="search-box2" placeholder="Tìm kiếm..." />
    <div class="table2">

      <table id="tbl-application2">
        <thead></thead>
        <tbody></tbody>
      </table>

      <div class="pagination" id="pagination2"></div>
    </div>



    <script type="module">
    
      document.addEventListener("DOMContentLoaded", () => {
        // FRONT-END pagination (serverSide: false)
        const table = new DataTableLib({
          
          api: "https://dummyjson.com/users?limit=100", // lấy nhiều data để phân trang ở client
          tableId: "tbl-application",
          searchBoxId: "search-box",
          loadingId: "loading",
          rows: 10,
          serverSide: false,
          sortable: true,
          pagination: true,
          paginationId: "pagination",
          searchDebounceMs: 650,
          columnsConfig: [
            { field: "id", label: "ID" },
            {
              field: "firstName",
              label: "First Name",
              render: (row) => `<b>${row.firstName}</b>`,
            },
            {
              field: "email",
              label: "Email",
              render: (row) => `<a href="mailto:${row.email}">${row.email}</a>`,
            },
          ],
        });
        table.init();

        // BACK-END pagination (serverSide: true)
        const table2 = new DataTableLib({
          api: "https://dummyjson.com/users",
          tableId: "tbl-application2",
          rows: 5,
          serverSide: true, // kích hoạt gọi API phân trang
          
          sortable: true,
          pagination: true,
          paginationId: "pagination2",
          searchDebounceMs: 650,
           
           searchBoxId: "search-box2",
          buildUrl: (page, searchTerm) => {
            // const limit = 5;
            const params={
              limit:5,
              skip: (page - 1) * 5,
              
            }
            
            // const limit = 5;
            // const skip = (page - 1) * limit;
             let url = `https://dummyjson.com/users?${new URLSearchParams(params).toString()}`;
            if (searchTerm) url += `&q=${encodeURIComponent(searchTerm)}`;
            return url;
          },
          formatData: (res) => res.users,
          columnsConfig: [
            { field: "id", label: "ID" },
            {
              field: "firstName",
              label: "First Name",
              render: (row) => `<b>${row.firstName}</b>`,
            },
            {
              field: "email",
              label: "Email",
              render: (row) => `<a href="mailto:${row.email}">${row.email}</a>`,
            },
          ],
        });
        table2.init();
      });
    </script>
  </body>
</html>
